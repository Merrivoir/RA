<html>
  <head>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="source/style.css">
    <link rel="apple-touch-icon" sizes="180x180" href="source/apple-touch-icon.png">
    <link rel="icon" type="image/png" sizes="32x32" href="source/favicon-32x32.png">
    <link rel="icon" type="image/png" sizes="16x16" href="source/favicon-16x16.png">
    <link rel="manifest" href="source/site.webmanifest">
    <title>Авторизация</title>
  </head>

  <body>

    <div class="login-container">
      <h1>Вход через Telegram</h1>
      <div id="telegram-widget">
      </div>
    </div>
      
    <script>
      document.addEventListener('DOMContentLoaded', () => {
        const params = new URLSearchParams(window.location.search);
        const source = params.get('source') || 'https://richmom.vercel.app';
        
        const tgcont = document.getElementById('telegram-widget');
        if (tgcont) {
          const script = document.createElement('script');
          script.async = true;
          script.src = 'https://telegram.org/js/telegram-widget.js?22';
          script.setAttribute('data-telegram-login', 'learnPytBot');
          script.setAttribute('data-size', 'large');
          script.setAttribute('data-radius', '4');
          script.setAttribute('data-auth-url', `https://richmom.vercel.app/auth?source=${encodeURIComponent(source)}`);
          script.setAttribute('data-request-access', 'write');
          tgcont.appendChild(script);
        }
      });
    </script>
    <script async src="https://telegram.org/js/telegram-widget.js?22" data-telegram-login="learnPytBot" data-size="large" data-radius="4" data-onauth="onTelegramAuth(user)"></script>
    <script type="text/javascript">
      function onTelegramAuth(user) {
        alert('Logged in as ' + user.first_name + ' ' + user.last_name + ' (' + user.id + (user.username ? ', @' + user.username : '') + ')');
      }
    </script>
      
  </body>

</html>