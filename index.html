<html>
  <head>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="/style.css">
    <link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png">
    <link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png">
    <link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png">
    <link rel="manifest" href="/site.webmanifest">
    <title>Авторизация</title>
  </head>

  <body>

    <div class="login-container">
      <h1>Вход через Telegram</h1>
      <div id="telegram-widget"></div>
    </div>
      
    <script>
      document.addEventListener('DOMContentLoaded', () => {
        const params = new URLSearchParams(window.location.search);
        const source = params.get('source') || 'https://richmom.vercel.app';
        console.log(`1.${source}`);
        const tgcont = document.getElementById('telegram-widget');
      
        // Убедимся, что контейнер существует
        if (tgcont) {
          // Создаём новый скрипт
          const script = document.createElement('script');
          script.async = true;
          script.src = 'https://telegram.org/js/telegram-widget.js?22';
          script.setAttribute('data-telegram-login', 'richmom_auth_bot');
          script.setAttribute('data-size', 'large');
          script.setAttribute('data-radius', '4');
          script.setAttribute('data-auth-url', `https://richmom.vercel.app/auth?source=${encodeURIComponent(source)}`);
          script.setAttribute('data-request-access', 'write');
      
          // Добавляем скрипт в контейнер
          tgcont.appendChild(script);
        } else {
          console.error('Элемент с id "telegram-widget" не найден');
        }
      });
    </script>
      
  </body>

</html>